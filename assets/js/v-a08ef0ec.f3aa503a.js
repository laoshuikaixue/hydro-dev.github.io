"use strict";(self.webpackChunkhydro_dev_github_io=self.webpackChunkhydro_dev_github_io||[]).push([[288],{2560:(s,a,e)=>{e.r(a),e.d(a,{data:()=>n});const n=JSON.parse('{"key":"v-a08ef0ec","path":"/plugins/hydrojudge.html","title":"hydrojudge","lang":"en-US","frontmatter":{"description":"您可以通过一键安装脚本快速安装独立评测机，详情请前往 部署Hydro (/docs/install/#部署) 查看。 准备 在配置评测机之前，请确认您的站点已经可以访问并正常登录/注册。 您应该预先下载您所要支持的语言的编译器，若您在配置完评测机后 升级/重新安装 了编译器，您需要重新启动沙箱。 关于编译器说明，请参照 编译器 (/docs/insta...","head":[["meta",{"property":"og:url","content":"https://hydro.js.org/plugins/hydrojudge.html"}],["meta",{"property":"og:site_name","content":"Hydro"}],["meta",{"property":"og:title","content":"hydrojudge"}],["meta",{"property":"og:description","content":"您可以通过一键安装脚本快速安装独立评测机，详情请前往 部署Hydro (/docs/install/#部署) 查看。 准备 在配置评测机之前，请确认您的站点已经可以访问并正常登录/注册。 您应该预先下载您所要支持的语言的编译器，若您在配置完评测机后 升级/重新安装 了编译器，您需要重新启动沙箱。 关于编译器说明，请参照 编译器 (/docs/insta..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-04-12T12:11:12.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-12T12:11:12.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"hydrojudge\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-04-12T12:11:12.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"准备","slug":"准备","link":"#准备","children":[]},{"level":2,"title":"安装","slug":"安装","link":"#安装","children":[{"level":3,"title":"作为附加组件","slug":"作为附加组件","link":"#作为附加组件","children":[]},{"level":3,"title":"作为独立进程","slug":"作为独立进程","link":"#作为独立进程","children":[]}]},{"level":2,"title":"更新","slug":"更新","link":"#更新","children":[]},{"level":2,"title":"关闭","slug":"关闭","link":"#关闭","children":[{"level":3,"title":"作为附加组件","slug":"作为附加组件-1","link":"#作为附加组件-1","children":[]},{"level":3,"title":"作为独立进程","slug":"作为独立进程-1","link":"#作为独立进程-1","children":[]}]},{"level":2,"title":"卸载","slug":"卸载","link":"#卸载","children":[]},{"level":2,"title":"评测设置","slug":"评测设置","link":"#评测设置","children":[{"level":3,"title":"作为附加组件","slug":"作为附加组件-2","link":"#作为附加组件-2","children":[]},{"level":3,"title":"作为独立进程","slug":"作为独立进程-2","link":"#作为独立进程-2","children":[]}]},{"level":2,"title":"修改编译选项/添加新语言支持","slug":"修改编译选项-添加新语言支持","link":"#修改编译选项-添加新语言支持","children":[]},{"level":2,"title":"测试数据格式","slug":"测试数据格式","link":"#测试数据格式","children":[]},{"level":2,"title":"调整沙箱空间大小","slug":"调整沙箱空间大小","link":"#调整沙箱空间大小","children":[]},{"level":2,"title":"C/C++ 彩色编译错误信息","slug":"c-c-彩色编译错误信息","link":"#c-c-彩色编译错误信息","children":[]},{"level":2,"title":"开大程序运行栈空间","slug":"开大程序运行栈空间","link":"#开大程序运行栈空间","children":[]},{"level":2,"title":"提高测评精度","slug":"提高测评精度","link":"#提高测评精度","children":[]},{"level":2,"title":"内存计量不准确","slug":"内存计量不准确","link":"#内存计量不准确","children":[]}],"git":{"createdTime":1613893902000,"updatedTime":1712923872000,"contributors":[{"name":"Macesuted","email":"macesuted@qq.com","commits":19},{"name":"undefined","email":"i@undefined.moe","commits":11},{"name":"panda","email":"panda_dtdyy@outlook.com","commits":3},{"name":"Macesuted Kysic","email":"57275149+Macesuted@users.noreply.github.com","commits":1},{"name":"criyle","email":"gaoyang4425@gmail.com","commits":1},{"name":"代建杉","email":"wood3s@foxmail.com","commits":1}]},"readingTime":{"minutes":5.22,"words":1565},"filePathRelative":"plugins/hydrojudge.md","localizedDate":"February 21, 2021","autoDesc":true,"excerpt":""}')},8817:(s,a,e)=>{e.r(a),e.d(a,{default:()=>A});var n=e(6252);const l=(0,n._)("h1",{id:"hydrojudge",tabindex:"-1"},[(0,n._)("a",{class:"header-anchor",href:"#hydrojudge"},[(0,n._)("span",null,"hydrojudge")])],-1),o={class:"hint-container tip"},p=(0,n._)("p",{class:"hint-container-title"},"Tips",-1),r=(0,n._)("h2",{id:"准备",tabindex:"-1"},[(0,n._)("a",{class:"header-anchor",href:"#准备"},[(0,n._)("span",null,"准备")])],-1),t=(0,n._)("p",null,"在配置评测机之前，请确认您的站点已经可以访问并正常登录/注册。",-1),d=(0,n._)("p",null,[(0,n.Uk)("您应该预先下载您所要支持的语言的编译器，若您在配置完评测机后 升级/重新安装 了编译器，您需要重新启动沙箱。"),(0,n._)("br"),(0,n.Uk)(" 关于编译器说明，请参照 "),(0,n._)("a",{href:"/docs/install/compiler"},"编译器"),(0,n.Uk)(" 章节。")],-1),c=(0,n._)("br",null,null,-1),i={href:"https://github.com/criyle/go-judge/releases",target:"_blank",rel:"noopener noreferrer"},y=(0,n._)("code",null,"127.0.0.1:5050",-1),u=(0,n._)("strong",null,"以 root 权限",-1),h=(0,n.uE)('<h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装</span></a></h2><h3 id="作为附加组件" tabindex="-1"><a class="header-anchor" href="#作为附加组件"><span>作为附加组件</span></a></h3><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>由于用附加组件安装的评测机与 Hydro 必须在同一台服务器上，每一个 Hydro 实例最多只能有一台评测机由附加组件安装。</p></div><p>在安装 Hydro 的机器上运行下面的指令安装 <code>@hydrooj/hydrojudge</code>：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#88C0D0;">yarn</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">global</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">add</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">@hydrooj/hydrojudge</span></span>\n<span class="line"><span style="color:#88C0D0;">hydrooj</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">addon</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">add</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">@hydrooj/hydrojudge</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>重启 Hydro 后 hydrojudge 即可正常运行。</p><h3 id="作为独立进程" tabindex="-1"><a class="header-anchor" href="#作为独立进程"><span>作为独立进程</span></a></h3><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>该方法可以帮助您在任意服务器上部署评测机。</p></div>',8),E=(0,n.uE)('<p>然后在运行评测机的服务器上安装 HydroJudge ：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#88C0D0;">.</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&lt;(</span><span style="color:#88C0D0;">curl</span><span style="color:#A3BE8C;"> https://hydro.ac/setup.sh</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">--judge</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>创建目录 <code>~/.config/hydro</code>，在该目录下创建文件 <code>judge.yaml</code>，配置文件格式如下：</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#8FBCBB;">hosts</span><span style="color:#ECEFF4;">:</span></span>\n<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#8FBCBB;">localhost</span><span style="color:#ECEFF4;">:</span></span>\n<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">hydro</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;"># vj4 用户请在此处填写 vj4</span></span>\n<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#8FBCBB;">server_url</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">http://localhost/</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;"># Hydro 运行的网址</span></span>\n<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#8FBCBB;">uname</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">judge</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;"># 评测账号用户名</span></span>\n<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#8FBCBB;">password</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">abc123</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;"># 评测账号密码</span></span>\n<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#8FBCBB;">detail</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">true</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;"># 默认为 true</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>设置完之后，使用下面的指令即可开始运行（可以使用 pm2 管理）：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#88C0D0;">hydrojudge</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="更新" tabindex="-1"><a class="header-anchor" href="#更新"><span>更新</span></a></h2><p>HydroJudge 会发布不定期更新。您可以使用 <code>yarn global upgrade-interactive --latest</code> 来检测并进行更新。</p><h2 id="关闭" tabindex="-1"><a class="header-anchor" href="#关闭"><span>关闭</span></a></h2><h3 id="作为附加组件-1" tabindex="-1"><a class="header-anchor" href="#作为附加组件-1"><span>作为附加组件</span></a></h3><p>在 系统设置&gt;hydrojudge 中有一栏 Disable builtin judge，将它勾上，然后重启 Hydro 即可。</p><h3 id="作为独立进程-1" tabindex="-1"><a class="header-anchor" href="#作为独立进程-1"><span>作为独立进程</span></a></h3><p>根据开启的方法关闭即可。</p><h2 id="卸载" tabindex="-1"><a class="header-anchor" href="#卸载"><span>卸载</span></a></h2><p>关闭后运行下面指令即可。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#88C0D0;">yarn</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">global</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">remove</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">@hydrooj/hydrojudge</span></span>\n<span class="line"><span style="color:#88C0D0;">hydrooj</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">addon</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">remove</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">@hydrooj/hydrojudge</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="评测设置" tabindex="-1"><a class="header-anchor" href="#评测设置"><span>评测设置</span></a></h2><h3 id="作为附加组件-2" tabindex="-1"><a class="header-anchor" href="#作为附加组件-2"><span>作为附加组件</span></a></h3><p>在 系统设置&gt;hydrojudge 修改对应的参数，然后重启 Hydro 和 hydrojudge 即可。</p><h3 id="作为独立进程-2" tabindex="-1"><a class="header-anchor" href="#作为独立进程-2"><span>作为独立进程</span></a></h3><p>如果有需要修改单题测试点数量上限等设置，可以在 <code>~/.config/hydro/judge.yaml</code> 的末尾添加下列内容：</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#8FBCBB;">testcases_max</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">100</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;"># 单题最多测试点数量</span></span>\n<span class="line"><span style="color:#8FBCBB;">total_time_limit</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">120</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;"># 单题最大总测试时长</span></span>\n<span class="line"><span style="color:#8FBCBB;">parallelism</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">2</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;"># 单评测机评测进程数量</span></span>\n<span class="line"><span style="color:#616E88;"># 更多可选配置均可添加在此处，格式与前面的三排类似</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',22),m={href:"https://github.com/hydro-dev/Hydro/blob/9c0afa38e3e6fa886ab9e9237847893fa6714392/packages/hydrojudge/src/config.ts#L12",target:"_blank",rel:"noopener noreferrer"},g=(0,n._)("h2",{id:"修改编译选项-添加新语言支持",tabindex:"-1"},[(0,n._)("a",{class:"header-anchor",href:"#修改编译选项-添加新语言支持"},[(0,n._)("span",null,"修改编译选项/添加新语言支持")])],-1),F=(0,n._)("p",null,[(0,n.Uk)("对于已安装内置评测机的用户（无论内置评测机是否启动），在 控制面板>系统设置 中修改 judge.langs 配置项即可；对于没有安装内置评测机的用户，需要在 "),(0,n._)("code",null,"~/.config/hydro/langs.yaml"),(0,n.Uk)(" 中配置。")],-1),b={href:"https://github.com/hydro-dev/Hydro/blob/71bb2f0b517be8f6966f97f835f2521f179b3d84/packages/hydrooj/setting.yaml#L12",target:"_blank",rel:"noopener noreferrer"},v=(0,n._)("p",null,[(0,n.Uk)("如果您添加了新的语言，您还需要前往 控制面板>系统设置 中修改 Language Highlight ID 与 Monaco language modes。"),(0,n._)("br"),(0,n.Uk)(" 分别表示选择对应的语言后的高亮设置（基于 PrismJS）和 Monaco 编辑器语法规则设置。")],-1),D=(0,n._)("p",null,"修改完后请重启 Hydro 和 hydrojudge 。",-1),f=(0,n._)("h2",{id:"测试数据格式",tabindex:"-1"},[(0,n._)("a",{class:"header-anchor",href:"#测试数据格式"},[(0,n._)("span",null,"测试数据格式")])],-1),k=(0,n.uE)('<h2 id="调整沙箱空间大小" tabindex="-1"><a class="header-anchor" href="#调整沙箱空间大小"><span>调整沙箱空间大小</span></a></h2><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>如果不调整沙箱的空间大小，当您的评测使用文件 IO 且输入输出文件较大时可能会引发错误。</p></div><p>对于 2022/8/12 前安装的用户：</p><p>在服务器上运行下面的代码找到 hydro-sandbox 的运行目录：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#88C0D0;">pm2</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">info</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">hydro-sandbox</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">grep</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">exec cwd</span><span style="color:#ECEFF4;">&quot;</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>',5),B={href:"https://github.com/criyle/go-judge/blob/master/mount.yaml",target:"_blank",rel:"noopener noreferrer"},C=(0,n._)("code",null,"size",-1),_=(0,n._)("code",null,"nr_inodes",-1),x=(0,n.uE)('<p>对于 2022/8/12 后安装的用户：</p><p>编辑 <code>/root/.hydro/mount.yaml</code>，修改 size 即可。</p><h2 id="c-c-彩色编译错误信息" tabindex="-1"><a class="header-anchor" href="#c-c-彩色编译错误信息"><span>C/C++ 彩色编译错误信息</span></a></h2><ol><li>确认您安装了支持彩色输出的编译器；</li><li>在系统设置中，将 C/C++ 编译命令后加上 <code>-fdiagnostics-color=always</code></li></ol><p>例：</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#8FBCBB;">c</span><span style="color:#ECEFF4;">:</span></span>\n<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#8FBCBB;">compile</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">/usr/bin/gcc -O2 -Wall -std=c99 -o ${name} foo.c -lm -fdiagnostics-color=always</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="开大程序运行栈空间" tabindex="-1"><a class="header-anchor" href="#开大程序运行栈空间"><span>开大程序运行栈空间</span></a></h2><p><strong>2022/8/12 后安装的实例默认已开启无限栈空间，无需手动操作</strong></p><p>在很多时候系统默认为程序提供的栈空间并不能满足我们的需求，此时我们需要手动为用户程序提供更大的栈空间。</p><p>修改 pm2 中 hydro-sandbox 的启动参数为 <code>ulimit -s unlimited &amp;&amp; /usr/bin/hydro-sandbox</code> ：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#88C0D0;">pm2</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">del</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">hydro-sandbox</span></span>\n<span class="line"><span style="color:#88C0D0;">pm2</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">start</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">bash</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">--name</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">hydro-sandbox</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">--</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">-c</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ulimit -s unlimited &amp;&amp; hydro-sandbox</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;"> </span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="提高测评精度" tabindex="-1"><a class="header-anchor" href="#提高测评精度"><span>提高测评精度</span></a></h2><p>禁用 CPU 频率缩放与 Intel 睿频加速技术，防止 CPU 频率波动。</p><p>禁用内存地址空间随机化，以使得存在内存寻址错误的代码能够得到更多可重复的结果，可以通过在 <code>/etc/sysctl.conf</code> 中添加下面这行并运行 <code>sudo sysctl -p</code> 应用：</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#d8dee9ff;">kernel.randomize_va_space = 0</span></span>\n<span class="line"><span style="color:#d8dee9ff;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="内存计量不准确" tabindex="-1"><a class="header-anchor" href="#内存计量不准确"><span>内存计量不准确</span></a></h2><p>在控制面板上出现内容为 <code>You are using cgroup v2 without kernel 5.19+. This could result in inaccurate memory usage measurements.</code> 警告时，意味着当前系统的内存消耗计量存在误差。</p><p>部分 Linux 设备默认使用 cgroup2，而在 5.19 版本前的内核的 cgroup2 中移除了精确计量内存消耗的接口。 若要获得更精确的内存计量，推荐启用 cgroup v1 (您可以通过检查 <code>/sys/fs/cgroup/memory/memory.memsw.usage_in_bytes</code> 是否存在来验证是否当前系统是否启用了 cgroup v1 )：</p><p>以 Ubuntu 的默认引导器 GRUB 2 为例，编辑 <code>/etc/default/grub</code>： 在其中</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#d8dee9ff;">GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet splash&quot;</span></span>\n<span class="line"><span style="color:#d8dee9ff;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>后，加入 `cgroup_enable=memory swapaccount=1 systemd.unified_cgroup_hierarchy=0，变为：</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#d8dee9ff;">GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet splash cgroup_enable=memory swapaccount=1 systemd.unified_cgroup_hierarchy=0&quot;</span></span>\n<span class="line"><span style="color:#d8dee9ff;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>运行以下命令更新 GRUB 2 的配置，然后重新启动。</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#d8dee9ff;">update-grub &amp;&amp; reboot</span></span>\n<span class="line"><span style="color:#d8dee9ff;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>',24),U={},A=(0,e(3744).Z)(U,[["render",function(s,a){const e=(0,n.up)("RouterLink"),U=(0,n.up)("ExternalLinkIcon");return(0,n.wg)(),(0,n.iD)("div",null,[l,(0,n._)("div",o,[p,(0,n._)("p",null,[(0,n.Uk)("您可以通过一键安装脚本快速安装独立评测机，详情请前往 "),(0,n.Wm)(e,{to:"/docs/install/#%E9%83%A8%E7%BD%B2"},{default:(0,n.w5)((()=>[(0,n.Uk)("部署Hydro")])),_:1}),(0,n.Uk)(" 查看。")])]),r,t,d,(0,n._)("p",null,[(0,n.Uk)("如果不使用自动脚本，您需要按照如下方式手动安装沙箱服务："),c,(0,n.Uk)(" 前往 "),(0,n._)("a",i,[(0,n.Uk)("criyle/go-judge"),(0,n.Wm)(U)]),(0,n.Uk)(" 下载对应 cpu 架构的 go-judge。 go-judge 需要在后台运行并监听 "),y,(0,n.Uk)(" 。如果系统使用的 cgroup 版本为 1 或者使用的为非 systemd init 的发行版，请"),u,(0,n.Uk)("运行。 可使用 pm2 进行管理。")]),h,(0,n._)("p",null,[(0,n.Uk)("首先需要创建一个有 PRIV_JUDGE 权限的账户，具体方法参照 "),(0,n.Wm)(e,{to:"/docs/system/cli/#%E5%88%9B%E5%BB%BA%E8%AF%84%E6%B5%8B%E8%B4%A6%E5%8F%B7"},{default:(0,n.w5)((()=>[(0,n.Uk)("此处")])),_:1}),(0,n.Uk)("。（在部署 Hydro 的服务器上运行）")]),E,(0,n._)("p",null,[(0,n.Uk)("在 "),(0,n._)("a",m,[(0,n.Uk)("此处"),(0,n.Wm)(U)]),(0,n.Uk)(" 的设置均可添加到此处。")]),g,F,(0,n._)("p",null,[(0,n.Uk)("文件格式参照 "),(0,n._)("a",b,[(0,n.Uk)("此处"),(0,n.Wm)(U)]),(0,n.Uk)(" 。")]),v,D,f,(0,n._)("p",null,[(0,n.Uk)("参照 "),(0,n.Wm)(e,{to:"/docs/user/problem/#%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F"},{default:(0,n.w5)((()=>[(0,n.Uk)("测试数据格式")])),_:1}),(0,n.Uk)(" 配置。")]),k,(0,n._)("p",null,[(0,n.Uk)("将 "),(0,n._)("a",B,[(0,n.Uk)("mount.yaml"),(0,n.Wm)(U)]),(0,n.Uk)(" 下载并放置在 sandbox 的运行目录下。然后修改第 64 行和第 68 行的 "),C,(0,n.Uk)(" 和 "),_,(0,n.Uk)(" 的大小至您想要的大小，保存后重启 sandbox 即可完成更改。")]),x])}]])},3744:(s,a)=>{a.Z=(s,a)=>{const e=s.__vccOpts||s;for(const[s,n]of a)e[s]=n;return e}}}]);