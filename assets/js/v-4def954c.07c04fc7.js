"use strict";(self.webpackChunkhydro_dev_github_io=self.webpackChunkhydro_dev_github_io||[]).push([[1672],{6240:(e,s,n)=>{n.r(s),n.d(s,{data:()=>a});const a=JSON.parse('{"key":"v-4def954c","path":"/docs/install/proxy.html","title":"反向代理 / SSL 配置","lang":"en-US","frontmatter":{"description":"2022/10/27 后使用脚本安装的实例已自动配置 Caddy 反向代理，请直接编辑位于 ~/.hydro/Caddyfile 的配置文件！ 若使用反向代理，请注意系统设置中的 server.xff 和 server.xhost 设置项需要填写正确（小写），分别对应反向代理所添加的标头名（通常为 x-forwarded-for 和 x-forward...","head":[["meta",{"property":"og:url","content":"https://hydro.js.org/docs/install/proxy.html"}],["meta",{"property":"og:site_name","content":"Hydro"}],["meta",{"property":"og:title","content":"反向代理 / SSL 配置"}],["meta",{"property":"og:description","content":"2022/10/27 后使用脚本安装的实例已自动配置 Caddy 反向代理，请直接编辑位于 ~/.hydro/Caddyfile 的配置文件！ 若使用反向代理，请注意系统设置中的 server.xff 和 server.xhost 设置项需要填写正确（小写），分别对应反向代理所添加的标头名（通常为 x-forwarded-for 和 x-forward..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2023-08-23T08:55:42.000Z"}],["meta",{"property":"article:modified_time","content":"2023-08-23T08:55:42.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"反向代理 / SSL 配置\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2023-08-23T08:55:42.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":3,"title":"2022/10/27 后使用脚本安装的实例已自动配置 Caddy 反向代理，请直接编辑位于 ~/.hydro/Caddyfile 的配置文件！","slug":"_2022-10-27-后使用脚本安装的实例已自动配置-caddy-反向代理-请直接编辑位于-hydro-caddyfile-的配置文件","link":"#_2022-10-27-后使用脚本安装的实例已自动配置-caddy-反向代理-请直接编辑位于-hydro-caddyfile-的配置文件","children":[]}],"git":{"createdTime":1629032113000,"updatedTime":1692780942000,"contributors":[{"name":"undefined","email":"i@undefined.moe","commits":6},{"name":"Macesuted","email":"macesuted@qq.com","commits":2},{"name":"panda","email":"panda_dtdyy@outlook.com","commits":1}]},"readingTime":{"minutes":1.2,"words":359},"filePathRelative":"docs/install/proxy.md","localizedDate":"August 15, 2021","autoDesc":true,"excerpt":""}')},5850:(e,s,n)=>{n.r(s),n.d(s,{default:()=>t});var a=n(6252);const d=(0,a.uE)('<h1 id="反向代理-ssl-配置" tabindex="-1"><a class="header-anchor" href="#反向代理-ssl-配置"><span>反向代理 / SSL 配置</span></a></h1><h3 id="_2022-10-27-后使用脚本安装的实例已自动配置-caddy-反向代理-请直接编辑位于-hydro-caddyfile-的配置文件" tabindex="-1"><a class="header-anchor" href="#_2022-10-27-后使用脚本安装的实例已自动配置-caddy-反向代理-请直接编辑位于-hydro-caddyfile-的配置文件"><span>2022/10/27 后使用脚本安装的实例已自动配置 Caddy 反向代理，请直接编辑位于 <code>~/.hydro/Caddyfile</code> 的配置文件！</span></a></h3><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>若使用反向代理，请注意系统设置中的 server.xff 和 server.xhost 设置项需要填写正确（小写），分别对应反向代理所添加的标头名（通常为 x-forwarded-for 和 x-forwarded-host，部分反代工具会使用 x-real-ip 替代 x-forwarded-for）。<br> server.xhost 设置项配置错误会导致用户无法登录等问题。(CsrfTokenError)<br> server.xff 设置项配置错误会导致无法记录用户IP。</p><p>除一键安装脚本在安装 Caddy 后会自动配置设置项，其他工具请在使用工具前先配置好系统设置！否则将造成用户无法登录、无法记录用户IP等问题。</p><p>若您使用 Nginx，请注意配置 WebSocket 协议的反向代理，否则会导致评测状态无法自动刷新，在线 IDE 无法正常使用等问题。</p></div>',3),l={href:"https://github.com/hydro-dev/Hydro/tree/master/examples/reverse_proxy",target:"_blank",rel:"noopener noreferrer"},r={href:"https://caddyserver.com/",target:"_blank",rel:"noopener noreferrer"},i=(0,a.uE)('<div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#d8dee9ff;">hydro.ac {</span></span>\n<span class="line"><span style="color:#d8dee9ff;">  log {</span></span>\n<span class="line"><span style="color:#d8dee9ff;">    output file /data/access.log {</span></span>\n<span class="line"><span style="color:#d8dee9ff;">      roll_size 1gb</span></span>\n<span class="line"><span style="color:#d8dee9ff;">      roll_keep_for 72h</span></span>\n<span class="line"><span style="color:#d8dee9ff;">    }</span></span>\n<span class="line"><span style="color:#d8dee9ff;">    format json</span></span>\n<span class="line"><span style="color:#d8dee9ff;">  }</span></span>\n<span class="line"><span style="color:#d8dee9ff;">  root * /root/.hydro/static</span></span>\n<span class="line"><span style="color:#d8dee9ff;">  @static {</span></span>\n<span class="line"><span style="color:#d8dee9ff;">    file {</span></span>\n<span class="line"><span style="color:#d8dee9ff;">      try_files {path}</span></span>\n<span class="line"><span style="color:#d8dee9ff;">    }</span></span>\n<span class="line"><span style="color:#d8dee9ff;">  }</span></span>\n<span class="line"><span style="color:#d8dee9ff;">  handle @static {</span></span>\n<span class="line"><span style="color:#d8dee9ff;">    file_server</span></span>\n<span class="line"><span style="color:#d8dee9ff;">  }</span></span>\n<span class="line"><span style="color:#d8dee9ff;">  handle {</span></span>\n<span class="line"><span style="color:#d8dee9ff;">    reverse_proxy http://127.0.0.1:8888</span></span>\n<span class="line"><span style="color:#d8dee9ff;">  }</span></span>\n<span class="line"><span style="color:#d8dee9ff;">}</span></span>\n<span class="line"><span style="color:#d8dee9ff;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',1),o={},t=(0,n(3744).Z)(o,[["render",function(e,s){const n=(0,a.up)("ExternalLinkIcon");return(0,a.wg)(),(0,a.iD)("div",null,[d,(0,a._)("p",null,[(0,a.Uk)("Hydro 支持使用 Caddy, HaProxy 等工具进行反向代理，"),(0,a._)("a",l,[(0,a.Uk)("此处"),(0,a.Wm)(n)]),(0,a.Uk)(" 提供了一些配置样例。")]),(0,a._)("p",null,[(0,a.Uk)("Hydro 推荐您使用 "),(0,a._)("a",r,[(0,a.Uk)("Caddy"),(0,a.Wm)(n)]),(0,a.Uk)("。以下为样例 Caddyfile。 提示：如果您的服务器位于国内，则需要进行备案后才能使用 80 和 443 端口。")]),i])}]])},3744:(e,s)=>{s.Z=(e,s)=>{const n=e.__vccOpts||e;for(const[e,a]of s)n[e]=a;return n}}}]);