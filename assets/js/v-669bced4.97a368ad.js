"use strict";(self.webpackChunkhydro_dev_github_io=self.webpackChunkhydro_dev_github_io||[]).push([[4833],{1459:(s,o,a)=>{a.r(o),a.d(o,{data:()=>n});const n=JSON.parse('{"key":"v-669bced4","path":"/plugins/migrate.html","title":"migrate","lang":"en-US","frontmatter":{"description":"从 HUSTOJ 升级 迁移会删除当前 Hydro 的所有数据（含用户账户信息）并移入 HUSTOJ 的数据。 请注意备份相关文件。 请先完成 Hydro 的部署并完成对文件服务的配置(setting_file)。 在迁移数据之前，请先停止正在运行的 HUSTOJ 服务，仅保留其数据库开启。 请注意 Hydro 所在的数据库不应和源 HUSTOJ 数据...","head":[["meta",{"property":"og:url","content":"https://hydro.js.org/plugins/migrate.html"}],["meta",{"property":"og:site_name","content":"Hydro"}],["meta",{"property":"og:title","content":"migrate"}],["meta",{"property":"og:description","content":"从 HUSTOJ 升级 迁移会删除当前 Hydro 的所有数据（含用户账户信息）并移入 HUSTOJ 的数据。 请注意备份相关文件。 请先完成 Hydro 的部署并完成对文件服务的配置(setting_file)。 在迁移数据之前，请先停止正在运行的 HUSTOJ 服务，仅保留其数据库开启。 请注意 Hydro 所在的数据库不应和源 HUSTOJ 数据..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2023-05-12T03:18:30.000Z"}],["meta",{"property":"article:modified_time","content":"2023-05-12T03:18:30.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"migrate\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2023-05-12T03:18:30.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"从 HUSTOJ 升级","slug":"从-hustoj-升级","link":"#从-hustoj-升级","children":[]},{"level":2,"title":"从 SYZOJ 升级","slug":"从-syzoj-升级","link":"#从-syzoj-升级","children":[]},{"level":2,"title":"从 UniversalOJ 升级","slug":"从-universaloj-升级","link":"#从-universaloj-升级","children":[]},{"level":2,"title":"从 Vijos 升级","slug":"从-vijos-升级","link":"#从-vijos-升级","children":[]}],"git":{"createdTime":1665539184000,"updatedTime":1683861510000,"contributors":[{"name":"panda","email":"panda_dtdyy@outlook.com","commits":3},{"name":"cyhforlight","email":"52744639+cyhforlight@users.noreply.github.com","commits":1},{"name":"undefined","email":"i@undefined.moe","commits":1}]},"readingTime":{"minutes":3.32,"words":995},"filePathRelative":"plugins/migrate.md","localizedDate":"October 12, 2022","autoDesc":true,"excerpt":""}')},4062:(s,o,a)=>{a.r(o),a.d(o,{default:()=>t});var n=a(6252);const l=[(0,n.uE)('<h1 id="migrate" tabindex="-1"><a class="header-anchor" href="#migrate"><span>migrate</span></a></h1><h2 id="从-hustoj-升级" tabindex="-1"><a class="header-anchor" href="#从-hustoj-升级"><span>从 HUSTOJ 升级</span></a></h2><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>迁移会删除当前 Hydro 的所有数据（含用户账户信息）并移入 HUSTOJ 的数据。<br> 请注意备份相关文件。</p></div><p>请先完成 Hydro 的部署并完成对文件服务的配置(setting_file)。 在迁移数据之前，请先停止正在运行的 HUSTOJ 服务，仅保留其数据库开启。 请注意 Hydro 所在的数据库不应和源 HUSTOJ 数据库相同。</p><p>安装插件后，您应当能够在 控制面板&gt;脚本管理 中找到名为 <code>migrateHustoj</code> 的脚本。 其参数格式如下：</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">host</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">localhost</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">port</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;">3306</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">jol</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">username</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">password</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">domainId</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">system</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">contestType</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">dataDir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">uploadDir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;&quot;</span><span style="color:#ECEFF4;">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>host: 数据库地址</li><li>port: 数据库端口</li><li>name: 数据库名，一般为 <code>jol</code></li><li>username&amp;password: 账号密码，若无则填写空字符串</li><li>domainId: 迁入的域，默认为 <code>system</code></li><li>contestType: <code>oi</code> 或者 <code>acm</code>，视情况而定</li><li>dataDir: HUSTOJ 中 data 文件夹的位置（这里存储着题目数据等关键信息，需要手动处理）</li><li>uploadDir: HUSTOJ 中 上传文件的位置（这里存储着上传的图片和文件等信息，默认已指定 <code>/home/judge/src/web/upload/</code> ，如果此路径与您路径相同，请不要填写此项）</li></ul><p>当脚本运行完成后，请重启 Hydro 实例，会自动完成之后的升级操作。 迁移后，请使用原 HUSTOJ 的管理员账号登录实例。</p><h2 id="从-syzoj-升级" tabindex="-1"><a class="header-anchor" href="#从-syzoj-升级"><span>从 SYZOJ 升级</span></a></h2><p>SYZOJ 与 HUSTOJ 迁移方法类似，迁移脚本应运行名为 <code>migrateSyzoj</code> 的脚本外，SYZOJ无需 <code>contestType</code> 参数。 其参数格式如下：</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">host</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">localhost</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">port</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;">3306</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">syzoj</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">username</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">password</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">domainId</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">system</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">dataDir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;&quot;</span><span style="color:#ECEFF4;">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>host: 数据库地址</li><li>port: 数据库端口</li><li>name: 数据库名，一般为 <code>syzoj</code></li><li>username&amp;password: 账号密码，若无则填写空字符串</li><li>domainId: 迁入的域，默认为 <code>system</code></li><li>dataDir: SYZOJ 中 data 文件夹的位置（这里存储着题目数据等关键信息，需要手动处理）</li></ul><p>由于SYZOJ脚本会将原站所有数据迁移，所以运行耗时较长。 当脚本运行完成后，请重启 Hydro 实例，会自动完成之后的升级操作。 迁移后，请使用原 SYZOJ 的管理员账号登录实例。</p><h2 id="从-universaloj-升级" tabindex="-1"><a class="header-anchor" href="#从-universaloj-升级"><span>从 UniversalOJ 升级</span></a></h2><p>UniversalOJ （常称作UOJ社区版）与前两者迁移方法类似，迁移脚本应运行名为 <code>migrateUniversalOJ</code> 的脚本。</p><p>由于其升级过程较为麻烦，安装脚本已提供自动升级服务，如您需要可运行安装脚本一键迁移，手动迁移请在开发群中提问。</p><p>由于UniversalOJ脚本会将原站所有数据迁移，所以运行耗时较长。 当脚本运行完成后，请重启 Hydro 实例，会自动完成之后的升级操作。 迁移后，请使用原 UniversalOJ 的管理员账号登录实例。</p><h2 id="从-vijos-升级" tabindex="-1"><a class="header-anchor" href="#从-vijos-升级"><span>从 Vijos 升级</span></a></h2><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>迁移会删除当前 Hydro 的所有数据（含用户账户信息）并移入 vj4 的数据。<br> 请注意备份相关文件。</p></div><p>请先完成 Hydro 的部署并完成对文件服务的配置(setting_file)。<br> 在迁移数据之前，请先停止正在运行的 vj4 服务，仅保留其数据库开启。<br> 请注意 Hydro 所在的数据库不应和源 vj4 数据库相同。<br> 若您使用 vj4-docker ，可更改 <code>docker-compose.yml</code> 将数据库映射至其他本机端口。</p><p>安装插件后，您应当能够在 控制面板&gt;脚本管理 中找到名为 <code>migrateVijos</code> 的脚本。<br> 其参数格式如下：</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki nord" style="background-color:#2e3440ff;" tabindex="0"><code><span class="line"><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">host</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">localhost</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">port</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;">27017</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">vj4</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">username</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">password</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;&quot;</span><span style="color:#ECEFF4;">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>host: 数据库地址</li><li>port: 数据库端口</li><li>name: 数据库名</li><li>username&amp;password: 账号密码，若无则填写空字符串</li></ul><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>vj4-docker 中数据库名为 vj4，无账号密码。</p></div><p>当脚本运行完成后，请重启 Hydro 实例，会自动完成之后的升级操作。 迁移后，请使用原 vj4 的管理员账号登录实例。</p><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>若您的 vj4 是由 vj2 或 tyvj 升级而来，在迁移完成后请不要卸载该插件，否则可能导致部分用户无法登录。</p></div>',26)],e={},t=(0,a(3744).Z)(e,[["render",function(s,o){return(0,n.wg)(),(0,n.iD)("div",null,l)}]])},3744:(s,o)=>{o.Z=(s,o)=>{const a=s.__vccOpts||s;for(const[s,n]of o)a[s]=n;return a}}}]);